#@TYPE: Machine
#@NAME: i.MX 8MP Consolidated`Machine
#@DESCRIPTION: A consolidated machine for i.MX 8MP LPDDR4 ROM5722 A1 Board
#@MAINTAINER: Clayder.Huang <clayder.huang@advantech.com.tw>
#
require conf/machine/include/adv-imx8mp-evk.inc

# The device tree name is implicit for LPDDR4, so can't use MACHINE here
KERNEL_DEVICETREE_BASENAME = "imx8mp-rom5722-a1"

# Mainline kernel contains only one DTB file for
# Advantech imx8mp machine
KERNEL_DEVICETREE = " \
    freescale/${KERNEL_DEVICETREE_BASENAME}.dtb \
    freescale/${KERNEL_DEVICETREE_BASENAME}-adv7535.dtb \
    freescale/${KERNEL_DEVICETREE_BASENAME}-auog101uan02.dtb \
    freescale/${KERNEL_DEVICETREE_BASENAME}-basler.dtb \
    freescale/${KERNEL_DEVICETREE_BASENAME}-m2-sdio.dtb \
    freescale/${KERNEL_DEVICETREE_BASENAME}-lvds-dual.dtb \
    freescale/${KERNEL_DEVICETREE_BASENAME}-lvds0-auo.dtb \
    freescale/${KERNEL_DEVICETREE_BASENAME}-lvds1-auo.dtb \
"

UBOOT_CONFIG_BASENAME = "imx8mp_rom5722a1"

UBOOT_CONFIG ??= "6G"
UBOOT_CONFIG[6G] = "${UBOOT_CONFIG_BASENAME}_6G_defconfig,sdcard"
UBOOT_CONFIG[4G] = "${UBOOT_CONFIG_BASENAME}_4G_defconfig,sdcard"
UBOOT_CONFIG[FSPI_6G] = "${UBOOT_CONFIG_BASENAME}_6G_defconfig"
UBOOT_CONFIG[FSPI_4G] = "${UBOOT_CONFIG_BASENAME}_4G_defconfig"
UBOOT_CONFIG[mfgtool] = "${UBOOT_CONFIG_BASENAME}_6G_defconfig"

# Set DDR FIRMWARE
DDR_FIRMWARE_VERSION = "202006"
DDR_FIRMWARE_NAME = " \
	lpddr4_pmu_train_1d_dmem_${DDR_FIRMWARE_VERSION}.bin \
	lpddr4_pmu_train_1d_imem_${DDR_FIRMWARE_VERSION}.bin \
	lpddr4_pmu_train_2d_dmem_${DDR_FIRMWARE_VERSION}.bin \
	lpddr4_pmu_train_2d_imem_${DDR_FIRMWARE_VERSION}.bin \
"

IMXBOOT_TARGETS = \
    "${@bb.utils.contains_any('UBOOT_CONFIG', 'FSPI_6G FSPI_4G', 'flash_evk_flexspi', \
                                                  'flash_evk', d)}"

# Set Serial console
SERIAL_CONSOLES = ";"
